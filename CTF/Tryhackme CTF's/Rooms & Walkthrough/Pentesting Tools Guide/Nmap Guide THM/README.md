# [Nmap](https://tryhackme.com/room/furthernmap)

An in depth look at scanning with Nmap, a powerful network scanning tool.

![](https://i.imgur.com/3XAfRpI.png)

> hamza , 28/2/2022

-----

* What networking constructs are used to direct traffic to the right application on a server?

`Ports`

* How many of these are available on any network-enabled computer?

`65535`

* How many of these are considered "well-known"? 

`1024`

## Nmap Switches

- What is the first switch listed in the help menu for a [Syn Scan](https://www.computerhope.com/jargon/s/syn.htm) ?

![](https://i.imgur.com/5Zyq2E7.png)

`-sS`

- Which switch would you use for a "UDP scan"?

`-sU`

- If you wanted to detect which operating system the target is running on, which switch would you use?

![](https://i.imgur.com/MR77uiW.png)

`-O`

- Nmap provides a switch to detect the version of the services running on the target. What is this switch?

![](https://i.imgur.com/hvYy7vp.png)

`-sV`

- How would you increase the verbosity?

`-v`

- How to increase verbosity level 2 ?

`-vv`

- What switch would you use to save the nmap results in three major formats?

`-oA`

- What switch would you use to save the nmap results in a "normal" format?

`-oN`

- A very useful output format: how would you save results in a "grepable" format?

`-oG`

- we can enable "aggressive" mode

`-A`

- How would you set the timing template to level 5?

`-T5`

- How would you tell nmap to only scan port 80?

![](https://i.imgur.com/UJCu7vZ.png)

`-p 80`

- How would you tell nmap to scan ports 1000-1500?

![](https://i.imgur.com/sp31dJE.png)

`-p 1000-1500`

- How would you tell nmap to scan all ports? **65k too long**

`-p-`

- How would you activate a script from the nmap scripting library (lots more on this later!)?

**PRACTICE**

`--script`

- How would you activate all of the scripts in the "vuln" category?

`--script=vuln`


- There are two other names for a SYN scan, what are they?

`Half-Open, Stealth`

- Can Nmap use a SYN scan without Sudo permissions (Y/N)?

`N`

- If a UDP port doesn't respond to an Nmap scan, what will it be marked as?

`open|filtered`

- When a UDP port is closed, by convention the target should send back a "port unreachable" message. Which protocol would it use to do so?

`ICMP`

- Which of the three shown scan types uses the URG flag?

`xmas`

- Why are NULL, FIN and Xmas scans generally used?

`Firewall Evasion`

- Which common OS may respond to a NULL, FIN or Xmas scan with a RST for every port?

`Microsoft Windows`

- How would you perform a ping sweep on the 172.16.x.x network

![](https://i.imgur.com/PBYWEgG.png)

```bash
nmap -sn $ip/mask
```

- What language are NSE scripts written in?

`Lua`

- Which category of scripts would be a very bad idea to run in a production environment?

`intrusive`

- What optional argument can the ftp-anon.nse script take?

`maxlist`

- What is the filename of the script which determines the underlying OS of the SMB server?

`smb-os-discovery.nse`

- Read through this script. What does it depend on?

`smb-brute`

- Which simple (and frequently relied upon) protocol is often blocked, requiring the use of the -Pn switch?

`ping`

- Which Nmap switch allows you to append an arbitrary length of random data to the end of packets?

`--data-length`

---------

## PRACTICAL


- Does the target respond to ICMP (ping) requests (Y/N)?

![](https://i.imgur.com/zjPdSHV.png)

`N`

- Perform an Xmas scan on the first 999 ports of the target -- how many ports are shown to be open or filtered?

![](https://i.imgur.com/UeNMIw9.png)

```bash
sudo nmap -Pn -sX 
```
`999`


- Perform a TCP SYN scan on the first 5000 ports of the target -- how many ports are shown to be open?

![](https://i.imgur.com/7Eovnav.png)

```bash
sudo nmap -Pn -sS
```

`5`

- Deploy the ftp-anon script against the box. Can Nmap login successfully to the FTP server on port 21?

![](https://i.imgur.com/4u1ISzx.png)

```bash
sudo nmap -Pn --script=ftp-anon 
```

`Y`





